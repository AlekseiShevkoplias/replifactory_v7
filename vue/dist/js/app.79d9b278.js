(function(){"use strict";var e={5500:function(e,t,o){var n=o(942);const a={id:"app"},l={class:"nav nav-tabs",id:"myTab"},r=["onClick"],i={class:"tab-content"};function s(e,t,o,s,c,d){const u=(0,n.resolveComponent)("HomeTab"),p=(0,n.resolveComponent)("ExperimentTab"),m=(0,n.resolveComponent)("DeviceControl"),h=(0,n.resolveComponent)("NgrokTab");return(0,n.openBlock)(),(0,n.createElementBlock)("div",a,[(0,n.createElementVNode)("ul",l,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(c.tabs,(e=>((0,n.openBlock)(),(0,n.createElementBlock)("li",{class:"nav-item",key:e},[(0,n.createElementVNode)("a",{class:(0,n.normalizeClass)(["nav-link",{active:c.currentTab===e}]),href:"#",onClick:t=>c.currentTab=e},(0,n.toDisplayString)(e),11,r)])))),128))]),(0,n.createElementVNode)("div",i,["Home"===c.currentTab?((0,n.openBlock)(),(0,n.createBlock)(u,{key:0})):(0,n.createCommentVNode)("",!0),"Experiment"===c.currentTab?((0,n.openBlock)(),(0,n.createBlock)(p,{key:1})):(0,n.createCommentVNode)("",!0),"Device"===c.currentTab?((0,n.openBlock)(),(0,n.createBlock)(m,{key:2})):(0,n.createCommentVNode)("",!0),"Remote"===c.currentTab?((0,n.openBlock)(),(0,n.createBlock)(h,{key:3})):(0,n.createCommentVNode)("",!0)])])}const c={class:"DeviceControl"},d=["checked"];function u(e,t,o,a,l,r){const i=(0,n.resolveComponent)("PumpControl"),s=(0,n.resolveComponent)("ValveControl"),u=(0,n.resolveComponent)("StirrerControl"),p=(0,n.resolveComponent)("ODControl");return(0,n.openBlock)(),(0,n.createElementBlock)("div",c,[(0,n.createElementVNode)("label",null,[(0,n.createTextVNode)(" Calibration mode: "),(0,n.createElementVNode)("input",{type:"checkbox",checked:e.calibrationModeEnabled,onChange:t[0]||(t[0]=(...t)=>e.toggleCalibrationMode&&e.toggleCalibrationMode(...t))},null,40,d)]),(0,n.createVNode)(i),(0,n.createVNode)(s),(0,n.createVNode)(u),(0,n.createVNode)(p)])}const p=e=>((0,n.pushScopeId)("data-v-012229b7"),e=e(),(0,n.popScopeId)(),e),m={class:"pump-controls"},h=["onClick","disabled"],v={key:0,class:"spinner-border spinner-custom",role:"status"},b={key:1},k={class:"pump-input"},g={class:"form-group"},V=p((()=>(0,n.createElementVNode)("label",{for:"volume"},"Volume (ml):",-1))),E={key:0,class:"form-group"},w=p((()=>(0,n.createElementVNode)("label",{for:"calibration"},"Calibration:",-1))),C={class:"form-group"},y=p((()=>(0,n.createElementVNode)("label",{for:"rotations"},"Pump rotations:",-1)));function N(e,t,o,a,l,r){const i=(0,n.resolveComponent)("CFormInput"),s=(0,n.resolveComponent)("PumpCalibration");return(0,n.openBlock)(),(0,n.createElementBlock)("div",m,[((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(3,(t=>(0,n.createElementVNode)("div",{class:"pump",key:t},[(0,n.createElementVNode)("button",{class:"pump-button",onClick:e=>r.handlePumpClick(t),disabled:"running"===e.pumps.states[t]},["running"===e.pumps.states[t]?((0,n.openBlock)(),(0,n.createElementBlock)("div",v)):((0,n.openBlock)(),(0,n.createElementBlock)("span",b,"Run Pump "+(0,n.toDisplayString)(t),1))],8,h),(0,n.createElementVNode)("div",k,[(0,n.createElementVNode)("div",g,[V,(0,n.createVNode)(i,{id:"volume",type:"float",size:"lg",value:e.pumps.volume[t],onInput:e=>r.onVolumeInput(e,t)},null,8,["value","onInput"])]),e.calibrationModeEnabled?((0,n.openBlock)(),(0,n.createElementBlock)("div",E,[w,(0,n.createVNode)(s,{pumpId:t},null,8,["pumpId"])])):(0,n.createCommentVNode)("",!0),(0,n.createElementVNode)("div",C,[y,(0,n.createVNode)(i,{id:"rotations",type:"float",size:"sm",value:l.rotations[t],onInput:e=>r.onRotationsInput(e,t)},null,8,["value","onInput"])])])]))),64))])}var f=o(3907),B=o(8549);const I=e=>((0,n.pushScopeId)("data-v-5eeb9a2e"),e=e(),(0,n.popScopeId)(),e),S={class:"pump-data"},x=I((()=>(0,n.createElementVNode)("tr",null,[(0,n.createElementVNode)("th",null,"Rots"),(0,n.createElementVNode)("th",null,"Reps"),(0,n.createElementVNode)("th"),(0,n.createElementVNode)("th",null,"Total mLs"),(0,n.createElementVNode)("th",null,"mL per Rot")],-1))),D=["onClick"],P=["onUpdate:modelValue","onInput"];function R(e,t,o,a,l,r){return(0,n.openBlock)(),(0,n.createElementBlock)("div",S,[(0,n.createElementVNode)("table",null,[x,((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(l.rows,((t,a)=>((0,n.openBlock)(),(0,n.createElementBlock)("tr",{key:a},[(0,n.createElementVNode)("td",null,(0,n.toDisplayString)(t.rotations),1),(0,n.createElementVNode)("td",null,(0,n.toDisplayString)(t.iterations),1),(0,n.createElementVNode)("td",null,[(0,n.createElementVNode)("button",{onClick:e=>r.promptForMl(t)},"Pump",8,D)]),(0,n.createElementVNode)("td",null,[(0,n.withDirectives)((0,n.createElementVNode)("input",{"onUpdate:modelValue":e=>t.total_ml=e,onInput:e=>r.onTotalMlInput(t),type:"number"},null,40,P),[[n.vModelText,t.total_ml]])]),(0,n.createElementVNode)("td",null,(0,n.toDisplayString)(e.pumps.calibration[o.pumpId][t.rotations].toFixed(3)),1)])))),128))])])}var T={data(){return{rows:[{rotations:1,iterations:50,total_ml:NaN},{rotations:5,iterations:10,total_ml:NaN},{rotations:10,iterations:5,total_ml:NaN},{rotations:50,iterations:1,total_ml:NaN}]}},props:{pumpId:{type:Number,required:!0}},computed:{...(0,f.rn)("device",["calibrationModeEnabled","pumps"])},methods:{...(0,f.nv)("device",["setPartCalibrationAction"]),onTotalMlInput(e){e.total_ml&&(this.pumps.calibration[this.pumpId][e.rotations]=e.total_ml/e.rotations/e.iterations,this.setPartCalibrationAction({devicePart:"pumps",partIndex:this.pumpId,newCalibration:this.pumps.calibration[this.pumpId]}))},promptForMl(e){const t=parseFloat(prompt("Enter total mL pumped"));isNaN(t)||(e.total_ml=t,this.onTotalMlInput(e))}}},O=o(3744);const A=(0,O.Z)(T,[["render",R],["__scopeId","data-v-5eeb9a2e"]]);var F=A,M={components:{PumpCalibration:F,CFormInput:B.jO},name:"PumpControl",data(){return{rotations:{1:0,2:0,3:0}}},computed:{...(0,f.rn)("device",["pumps","valves","calibrationModeEnabled"])},methods:{...(0,f.nv)("device",["setPartStateAction"]),async handlePumpClick(e){const t=Object.values(this.valves.states).some((e=>"open"===e));if(!t)return void alert("At least one valve must be open to start the pump");const o=this.pumps.input[e].volume;if(o)try{await this.setPartStateAction({devicePart:"pumps",partIndex:e,newState:"running",input:this.pumps.input[e]})}catch(n){console.error(n)}finally{await this.setPartStateAction({devicePart:"pumps",partIndex:e,newState:"stopped"})}else alert("Please set the volume before starting the pump")},onVolumeInput(e,t){this.volume=e.target.value;const o=parseFloat(this.volume);isNaN(o)?this.rotations[t]="":this.rotations[t]=this.calculateRotations(o,t).toString()},onRotationsInput(e,t){this.rotations[t]=e.target.value;const o=parseFloat(this.rotations[t]);isNaN(o)?this.pumps.volume[t]="":this.pumps.volume[t]=this.calculateVolume(o,t).toString()},calculateRotations(e,t){const o={1:{1:.2,5:.19,10:.17,50:.16}},n=o[t],a=Object.entries(n).map((([e,t])=>[parseInt(e),t])).sort(((e,t)=>e[0]-t[0]));let l=a[0],r=a[a.length-1];for(let d=0;d<a.length-1;d++)if(e>=a[d][0]&&e<=a[d+1][0]){l=a[d],r=a[d+1];break}const i=(e-l[0])/(r[0]-l[0]),s=l[1]+(r[1]-l[1])*i,c=e/s;return c},calculateVolume(e,t){const o=this.pumps.calibration[t];let n=0;n=e<1?o[1]:e<5?o[1]+(e-1)*(o[5]-o[1])/4:e<10?o[5]+(e-5)*(o[10]-o[5])/5:e<50?o[10]+(e-10)*(o[50]-o[10])/40:o[50];const a=e*n;return a.toFixed(2)}}};const _=(0,O.Z)(M,[["render",N],["__scopeId","data-v-012229b7"]]);var L=_;const U={class:"valve-controls"},Z=["onClick","disabled"],$={key:0,class:"spinner-border spinner-custom",role:"status"},j={key:1};function X(e,t,o,a,l,r){return(0,n.openBlock)(),(0,n.createElementBlock)("div",U,[((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(7,(t=>(0,n.createElementVNode)("button",{class:(0,n.normalizeClass)(["btn",{"btn-danger":"closed"===e.valves.states[t]&&!l.togglingValves[t],"btn-success":"open"===e.valves.states[t]&&!l.togglingValves[t],"btn-warning":l.togglingValves[t]}]),key:t,onClick:e=>r.toggleValve(t),disabled:l.togglingValves[t]},[l.togglingValves[t]?((0,n.openBlock)(),(0,n.createElementBlock)("div",$)):((0,n.openBlock)(),(0,n.createElementBlock)("span",j,"Valve "+(0,n.toDisplayString)(t),1))],10,Z))),64))])}var Y={name:"ValveControl",computed:(0,f.rn)("device",["valves"]),data(){return{audioContext:new(window.AudioContext||window.webkitAudioContext),togglingValves:{}}},methods:{...(0,f.nv)("device",["setPartStateAction"]),toggleValve(e){const t=this.valves.states[e];if(this.togglingValves[e])return;this.togglingValves={...this.togglingValves,[e]:!0};const o=this.playValveSound(t);this.setPartStateAction({devicePart:"valves",partIndex:e,newState:"open"===t?"closed":"open"}).then((()=>{o.stop(),this.togglingValves={...this.togglingValves,[e]:!1}})).catch((e=>{console.error(e)}))},playValveSound(e){const t="open"===e?500:300,o="open"===e?300:500,n=this.audioContext.createOscillator();n.type="sine";const a=this.audioContext.createGain();return a.gain.setValueAtTime(.1,this.audioContext.currentTime),n.connect(a),a.connect(this.audioContext.destination),n.frequency.setValueAtTime(t,this.audioContext.currentTime),n.frequency.linearRampToValueAtTime(o,this.audioContext.currentTime+.3),n.start(),n}}};const z=(0,O.Z)(Y,[["render",X],["__scopeId","data-v-c85b5788"]]);var K=z;const H={class:"stirrer-controls"};function q(e,t,o,a,l,r){const i=(0,n.resolveComponent)("StirrerCalibration");return(0,n.openBlock)(),(0,n.createElementBlock)("div",H,[((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(7,(e=>(0,n.createVNode)(i,{key:e,stirrerId:e},null,8,["stirrerId"]))),64))])}const G={class:"stirrer-calibrator",ref:"container"},W={class:"elements-container"},J={key:0},Q=["min","max"],ee=["min","max"],te={class:"svg-container"},oe=["x1","y1","x2","y2"],ne=["x1","y1","x2","y2"],ae={class:"buttons-container"};function le(e,t,o,a,l,r){return(0,n.openBlock)(),(0,n.createElementBlock)("div",G,[(0,n.createElementVNode)("div",W,[e.calibrationModeEnabled?((0,n.openBlock)(),(0,n.createElementBlock)("div",J,[(0,n.withDirectives)((0,n.createElementVNode)("input",{type:"range",class:(0,n.normalizeClass)(["slider slider-high",{active:"high"===r.currentStirrerState}]),min:l.min,max:l.max,"onUpdate:modelValue":t[0]||(t[0]=t=>e.stirrers.calibration[o.stirrerId].high=t),onInput:t[1]||(t[1]=e=>r.onSliderInput("high",e))},null,42,Q),[[n.vModelText,e.stirrers.calibration[o.stirrerId].high]]),(0,n.withDirectives)((0,n.createElementVNode)("input",{type:"range",class:(0,n.normalizeClass)(["slider slider-low",{active:"low"===r.currentStirrerState}]),min:l.min,max:l.max,"onUpdate:modelValue":t[2]||(t[2]=t=>e.stirrers.calibration[o.stirrerId].low=t),onInput:t[3]||(t[3]=e=>r.onSliderInput("low",e))},null,42,ee),[[n.vModelText,e.stirrers.calibration[o.stirrerId].low]]),((0,n.openBlock)(),(0,n.createElementBlock)("svg",te,[(0,n.createElementVNode)("line",{x1:l.lowX1,y1:l.lowY1,x2:l.lowX2,y2:l.lowY2,stroke:"gray","stroke-width":"1"},null,8,oe),(0,n.createElementVNode)("line",{x1:l.highX1,y1:l.highY1,x2:l.highX2,y2:l.highY2,stroke:"gray","stroke-width":"1"},null,8,ne)]))])):(0,n.createCommentVNode)("",!0),(0,n.createElementVNode)("div",ae,[(0,n.createElementVNode)("button",{class:(0,n.normalizeClass)(["button button-high",{active:"high"===r.currentStirrerState}]),ref:"buttonHigh",onClick:t[4]||(t[4]=e=>r.onClick("high")),onDblclick:t[5]||(t[5]=e=>r.onDoubleClick("high"))}," High ",34),(0,n.createElementVNode)("button",{class:(0,n.normalizeClass)(["button button-low",{active:"low"===r.currentStirrerState}]),ref:"buttonLow",onClick:t[6]||(t[6]=e=>r.onClick("low")),onDblclick:t[7]||(t[7]=e=>r.onDoubleClick("low"))}," Low ",34),(0,n.createElementVNode)("button",{class:(0,n.normalizeClass)(["button button-off",{active:"stopped"===r.currentStirrerState}]),ref:"buttonOff",onClick:t[8]||(t[8]=e=>r.onClick("stopped")),onDblclick:t[9]||(t[9]=e=>r.onDoubleClick("stopped"))}," Off ",34)])])],512)}var re={name:"StirrerCalibration",props:{stirrerId:{type:Number,required:!0}},watch:{calibrationModeEnabled(e){e&&this.$nextTick(this.updateLine)}},data(){return{min:0,max:100,lowX1:0,lowY1:0,lowX2:0,lowY2:0,highX1:0,highY1:0,highX2:0,highY2:0,audioContext:new(window.AudioContext||window.webkitAudioContext)}},computed:{...(0,f.rn)("device",["calibrationModeEnabled","stirrers"]),currentStirrerState(){return console.log(this.stirrerId,"stirrer state:",this.stirrers.states[this.stirrerId]),console.log(this.stirrers.states),this.stirrers.states[this.stirrerId]}},methods:{...(0,f.nv)("device",["setPartStateAction","setPartCalibrationAction","getAllDeviceData","setAllStirrersStateAction"]),onClick(e){console.log("onClick1",e,this.stirrers.states),this.setPartStateAction({devicePart:"stirrers",partIndex:this.stirrerId,newState:e}),console.log("onClick",e,this.stirrers.states)},onDoubleClick(e){this.setAllStirrersStateAction(e)},onSliderInput(e,t){"low"===e?this.stirrers.calibration[this.stirrerId].low=t.target.value:"high"===e&&(this.stirrers.calibration[this.stirrerId].high=t.target.value),this.updateLine(),this.setPartCalibrationAction({devicePart:"stirrers",partIndex:this.stirrerId,newCalibration:{low:this.stirrers.calibration[this.stirrerId].low,high:this.stirrers.calibration[this.stirrerId].high}}).then((()=>{this.playSound(t.target.value)})).catch((e=>{console.error("Error updating stirrer calibration:",e)}))},updateLine(){this.$nextTick((()=>{const e=this.$refs.container,t=e.getBoundingClientRect(),o=this.$el.querySelector(".slider-low"),n=this.$refs.buttonLow,a=o.getBoundingClientRect(),l=n.getBoundingClientRect();this.lowX1=a.x-t.x+a.width/2,this.lowY1=a.y-t.y+a.height*(1-this.stirrers.calibration[this.stirrerId].low/(this.max-this.min)),this.lowX2=l.x-t.x,this.lowY2=l.y-t.y+l.height/2;const r=this.$el.querySelector(".slider-high"),i=this.$refs.buttonHigh,s=r.getBoundingClientRect(),c=i.getBoundingClientRect();this.highX1=s.x-t.x+s.width/2,this.highY1=s.y-t.y+s.height*(1-this.stirrers.calibration[this.stirrerId].high/(this.max-this.min)),this.highX2=c.x-t.x,this.highY2=c.y-t.y+c.height/2}))},playSound(e){const t=300+5*e,o=this.audioContext.createOscillator();o.type="sine",o.frequency.setValueAtTime(t,this.audioContext.currentTime);const n=this.audioContext.createGain();n.gain.setValueAtTime(.1,this.audioContext.currentTime),o.connect(n),n.connect(this.audioContext.destination),o.start(),setTimeout((()=>{o.stop()}),100)}}};const ie=(0,O.Z)(re,[["render",le],["__scopeId","data-v-2aca20c0"]]);var se=ie,ce={name:"StirrerControl",components:{StirrerCalibration:se}};const de=(0,O.Z)(ce,[["render",q],["__scopeId","data-v-4030e64e"]]);var ue=de;const pe=e=>((0,n.pushScopeId)("data-v-fa07c0de"),e=e(),(0,n.popScopeId)(),e),me=pe((()=>(0,n.createElementVNode)("table",null,null,-1))),he={key:0},ve=pe((()=>(0,n.createElementVNode)("th",null,"OD values",-1))),be=pe((()=>(0,n.createElementVNode)("th",null,null,-1))),ke=pe((()=>(0,n.createElementVNode)("th",null,null,-1))),ge={key:1},Ve=["value","onInput"],Ee=["onClick"],we=["onUpdate:modelValue"],Ce=["onClick"],ye={key:2},Ne=["onClick"],fe={class:"od-output-value"},Be=pe((()=>(0,n.createElementVNode)("br",null,null,-1))),Ie={class:"od-output-value"};function Se(e,t,o,a,l,r){return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[me,(0,n.createElementVNode)("table",null,[e.calibrationModeEnabled?((0,n.openBlock)(),(0,n.createElementBlock)("thead",he,[(0,n.createElementVNode)("tr",null,[ve,be,((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(l.vials,(e=>((0,n.openBlock)(),(0,n.createElementBlock)("th",{key:e},(0,n.toDisplayString)("vial"+e),1)))),128)),ke])])):(0,n.createCommentVNode)("",!0),e.calibrationModeEnabled?((0,n.openBlock)(),(0,n.createElementBlock)("tbody",ge,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(l.odValues,((t,o)=>((0,n.openBlock)(),(0,n.createElementBlock)("tr",{key:o},[(0,n.createElementVNode)("td",null,[(0,n.createElementVNode)("input",{value:t,onInput:e=>r.updateODValue(e,o),type:"number",step:"0.1"},null,40,Ve)]),(0,n.createElementVNode)("td",null,[(0,n.createElementVNode)("button",{onClick:e=>r.measure(t)},"Measure",8,Ee)]),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(l.vials,(o=>((0,n.openBlock)(),(0,n.createElementBlock)("td",{key:o},[(0,n.withDirectives)((0,n.createElementVNode)("input",{class:"calibration-signal","onUpdate:modelValue":n=>e.ods.calibration[o][t]=n,type:"number"},null,8,we),[[n.vModelText,e.ods.calibration[o][t]]])])))),128)),(0,n.createElementVNode)("td",null,[(0,n.createElementVNode)("button",{class:"button button-delete",onClick:e=>r.clearRow(t,o)},"Delete Row",8,Ce)])])))),128)),(0,n.createElementVNode)("tr",null,[(0,n.createElementVNode)("td",null,[(0,n.withDirectives)((0,n.createElementVNode)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>l.newRowValue=e),type:"number",step:"0.1"},null,512),[[n.vModelText,l.newRowValue]])]),(0,n.createElementVNode)("td",null,[(0,n.createElementVNode)("button",{class:"button button-new",onClick:t[1]||(t[1]=(...e)=>r.addNewRow&&r.addNewRow(...e))},"New Row")])])])):((0,n.openBlock)(),(0,n.createElementBlock)("tbody",ye,[(0,n.createElementVNode)("tr",null,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.ods.states,((e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("td",{key:t},[(0,n.createElementVNode)("button",{class:"od-button",onClick:e=>r.handleOdClick(t)},[(0,n.createElementVNode)("span",null,"OD "+(0,n.toDisplayString)(t),1)],8,Ne)])))),128))]),(0,n.createElementVNode)("tr",null,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.ods.states,((t,o)=>((0,n.openBlock)(),(0,n.createElementBlock)("td",{key:o},[(0,n.createElementVNode)("span",fe,[(0,n.createTextVNode)((0,n.toDisplayString)(parseFloat(e.ods.states[o].toFixed(2))),1),Be]),(0,n.createElementVNode)("span",Ie,"("+(0,n.toDisplayString)(parseFloat(e.ods.states[o].toFixed(2)))+"mV)",1)])))),128))])]))])],64)}o(7658);var xe={data(){return{odValues:[.00788,.0158,.0315,.063,.126,.252,.504,1.01,2.02,4.03],vials:[1,2,3,4,5,6,7],newRowValue:null}},computed:{...(0,f.rn)("device",["ods","calibrationModeEnabled"])},methods:{...(0,f.OI)("device",["addODCalibrationRow"]),...(0,f.nv)("device",["getAllDeviceData","setPartStateAction","measureDevicePart","removeODCalibrationRow","setPartCalibration"]),async handleOdClick(e){await this.measureDevicePart({devicePart:"ods",partIndex:e}),await this.getAllDeviceData(),console.log(this.ods.states[e])},clearRow(e,t){this.odValues.splice(t,1)},addNewRow(){if(null!==this.newRowValue){this.addODCalibrationRow(this.newRowValue);const e=parseFloat(this.newRowValue);this.odValues.push(e),console.log("pushed new row value",e),this.newRowValue=null}},updateODValue(e,t){this.odValues[t]=parseFloat(e.target.value)},measure(e){for(let t of this.vials)this.setPartCalibration({devicePart:"ods",partIndex:t,calibration:{[e]:.1}})}}};const De=(0,O.Z)(xe,[["render",Se],["__scopeId","data-v-fa07c0de"]]);var Pe=De,Re={components:{PumpControl:L,ValveControl:K,StirrerControl:ue,ODControl:Pe},computed:{...(0,f.rn)("device",["calibrationModeEnabled","stirrers","pumps","valves","ods"])},mounted(){this.getAllDeviceData().then((()=>{}))},methods:{...(0,f.OI)("device",["toggleCalibrationMode"]),...(0,f.nv)("device",["getAllDeviceData"]),hideKeyboard(){this.isInputSelected=!1},updateInput(e){this.setKeyboardInput({value:e,active:this.keyboardInput.active})}}};const Te=(0,O.Z)(Re,[["render",u],["__scopeId","data-v-55f4e572"]]);var Oe=Te;const Ae={class:"HomeTab"},Fe=(0,n.createElementVNode)("h1",null,"Welcome to replifactory!",-1),Me=(0,n.createElementVNode)("p",null,"To start using the app, navigate to the 'Device' tab and start controlling your device.",-1),_e={class:"keyboard-container"};function Le(e,t,o,a,l,r){const i=(0,n.resolveComponent)("SimpleKeyboard"),s=(0,n.resolveDirective)("click-outside");return(0,n.openBlock)(),(0,n.createElementBlock)("div",Ae,[Fe,Me,(0,n.withDirectives)((0,n.createElementVNode)("input",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.keyboardInput.value=t),class:"input",onFocus:t[1]||(t[1]=t=>e.isInputSelected=!0),placeholder:"Tap on the virtual keyboard to start"},null,544),[[n.vModelText,e.keyboardInput.value]]),(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createElementBlock)("div",_e,[(0,n.withDirectives)((0,n.createVNode)(i,{input:e.keyboardInput.value,onInput:r.updateInput},null,8,["input","onInput"]),[[n.vShow,e.isInputSelected]])])),[[s,r.hideKeyboard]])])}function Ue(e,t,o,a,l,r){return(0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)(o.keyboardClass)},null,2)}var Ze=o(2086),$e=o.n(Ze),je={name:"SimpleKeyboard",props:{keyboardClass:{default:"simple-keyboard",type:String},input:{type:String,default:""}},data:()=>({keyboard:null}),mounted(){this.keyboard=new($e())(this.keyboardClass,{onChange:this.onChange,onKeyPress:this.keyPress})},methods:{onChange(e){this.$emit("input",e)},keyPress(e){console.log("button",e)}},watch:{input(e){this.keyboard.setInput(e)}}};const Xe=(0,O.Z)(je,[["render",Ue]]);var Ye=Xe,ze={name:"HomeTab",components:{SimpleKeyboard:Ye},data:()=>({isInputSelected:!1}),computed:{...(0,f.rn)(["keyboardInput"])},methods:{...(0,f.OI)(["setKeyboardInput"]),hideKeyboard(){this.isInputSelected=!1},updateInput(e){this.setKeyboardInput({value:e,active:this.keyboardInput.active})}}};const Ke=(0,O.Z)(ze,[["render",Le]]);var He=Ke;const qe=e=>((0,n.pushScopeId)("data-v-38edd392"),e=e(),(0,n.popScopeId)(),e),Ge=qe((()=>(0,n.createElementVNode)("table",null,null,-1))),We={key:0},Je=qe((()=>(0,n.createElementVNode)("th",null,"OD values",-1))),Qe=qe((()=>(0,n.createElementVNode)("th",null,null,-1))),et=qe((()=>(0,n.createElementVNode)("th",null,null,-1))),tt={key:1},ot=["value","onInput"],nt=["onClick"],at=["onUpdate:modelValue"],lt=["onClick"],rt={key:2},it=["onClick"],st={class:"od-output-value"},ct=qe((()=>(0,n.createElementVNode)("br",null,null,-1))),dt={class:"od-output-value"};function ut(e,t,o,a,l,r){return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[Ge,(0,n.createElementVNode)("table",null,[e.calibrationModeEnabled?((0,n.openBlock)(),(0,n.createElementBlock)("thead",We,[(0,n.createElementVNode)("tr",null,[Je,Qe,((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(l.vials,(e=>((0,n.openBlock)(),(0,n.createElementBlock)("th",{key:e},(0,n.toDisplayString)("vial"+e),1)))),128)),et])])):(0,n.createCommentVNode)("",!0),e.calibrationModeEnabled?((0,n.openBlock)(),(0,n.createElementBlock)("tbody",tt,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(l.odValues,((t,o)=>((0,n.openBlock)(),(0,n.createElementBlock)("tr",{key:o},[(0,n.createElementVNode)("td",null,[(0,n.createElementVNode)("input",{value:t,onInput:e=>r.updateODValue(e,o),type:"number",step:"0.1"},null,40,ot)]),(0,n.createElementVNode)("td",null,[(0,n.createElementVNode)("button",{onClick:e=>r.measure(t)},"Measure",8,nt)]),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(l.vials,(o=>((0,n.openBlock)(),(0,n.createElementBlock)("td",{key:o},[(0,n.withDirectives)((0,n.createElementVNode)("input",{"onUpdate:modelValue":n=>e.ods.calibration[o][t]=n,type:"number",readonly:""},null,8,at),[[n.vModelText,e.ods.calibration[o][t]]])])))),128)),(0,n.createElementVNode)("td",null,[(0,n.createElementVNode)("button",{class:"button button-delete",onClick:e=>r.clearRow(t,o)},"Delete Row",8,lt)])])))),128)),(0,n.createElementVNode)("tr",null,[(0,n.createElementVNode)("td",null,[(0,n.withDirectives)((0,n.createElementVNode)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>l.newRowValue=e),type:"number",step:"0.1"},null,512),[[n.vModelText,l.newRowValue]])]),(0,n.createElementVNode)("td",null,[(0,n.createElementVNode)("button",{class:"button button-new",onClick:t[1]||(t[1]=(...e)=>r.addNewRow&&r.addNewRow(...e))},"New Row")])])])):((0,n.openBlock)(),(0,n.createElementBlock)("tbody",rt,[(0,n.createElementVNode)("tr",null,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.ods.states,((e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("td",{key:t},[(0,n.createElementVNode)("button",{class:"od-button",onClick:e=>r.handleOdClick(t)},[(0,n.createElementVNode)("span",null,"OD "+(0,n.toDisplayString)(t),1)],8,it)])))),128))]),(0,n.createElementVNode)("tr",null,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.ods.states,((t,o)=>((0,n.openBlock)(),(0,n.createElementBlock)("td",{key:o},[(0,n.createElementVNode)("span",st,[(0,n.createTextVNode)((0,n.toDisplayString)(parseFloat(e.ods.states[o].toFixed(2))),1),ct]),(0,n.createElementVNode)("span",dt,"("+(0,n.toDisplayString)(parseFloat(e.ods.states[o].toFixed(2)))+"mV)",1)])))),128))])]))])],64)}var pt={data(){return{odValues:[.00788,.0158,.0315,.063,.126,.252,.504,1.01,2.02,4.03],vials:[1,2,3,4,5,6,7],newRowValue:null}},computed:{...(0,f.rn)("device",["ods","calibrationModeEnabled"])},methods:{...(0,f.OI)("device",["addODCalibrationRow"]),...(0,f.nv)("device",["removeODCalibrationRow","setPartCalibration"]),...(0,f.nv)("device",["getAllDeviceData","setPartStateAction","measureDevicePart"]),async handleOdClick(e){await this.measureDevicePart({devicePart:"ods",partIndex:e}),await this.getAllDeviceData(),console.log(this.ods.states[e])},clearRow(e,t){this.odValues.splice(t,1)},addNewRow(){if(null!==this.newRowValue){this.addODCalibrationRow(this.newRowValue);const e=parseFloat(this.newRowValue);this.odValues.push(e),console.log("pushed new row value",e),this.newRowValue=null}},updateODValue(e,t){this.odValues[t]=parseFloat(e.target.value)},measure(e){for(let t of this.vials)this.setPartCalibration({devicePart:"ods",partIndex:t,calibration:{[e]:.1}})}}};const mt=(0,O.Z)(pt,[["render",ut],["__scopeId","data-v-38edd392"]]);var ht=mt;const vt=(0,n.createElementVNode)("a",{style:{"margin-left":"30px"},href:"https://dashboard.ngrok.com/get-started/your-authtoken",target:"_blank"},"Get ngrok authtoken",-1),bt=(0,n.createElementVNode)("br",null,null,-1),kt=(0,n.createElementVNode)("br",null,null,-1),gt=["href"];function Vt(e,t,o,a,l,r){return(0,n.openBlock)(),(0,n.createElementBlock)("div",null,[(0,n.withDirectives)((0,n.createElementVNode)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>l.authtoken=e),placeholder:"ngrok authtoken"},null,512),[[n.vModelText,l.authtoken]]),(0,n.createElementVNode)("button",{onClick:t[1]||(t[1]=(...e)=>r.sendAuthtoken&&r.sendAuthtoken(...e))},"Connect"),vt,bt,kt,(0,n.createElementVNode)("p",null,[(0,n.createTextVNode)("Ngrok URL: "),(0,n.createElementVNode)("a",{href:l.ngrokUrl,target:"_blank"},(0,n.toDisplayString)(l.ngrokUrl),9,gt)])])}var Et=o(6154),wt={data(){return{authtoken:"",ngrokUrl:""}},created(){Et.Z.get("/api/get-ngrok-url").then((e=>{console.log(e),this.ngrokUrl=e.data.ngrokUrl})).catch((e=>{console.log(e)}))},methods:{sendAuthtoken(){Et.Z.post("/api/setNgrokauthtoken",{authtoken:this.authtoken}).then((e=>{console.log(e),this.ngrokUrl=e.data.ngrokUrl})).catch((e=>{console.log(e)}))}}};const Ct=(0,O.Z)(wt,[["render",Vt]]);var yt=Ct,Nt={name:"App",components:{HomeTab:He,ExperimentTab:ht,DeviceControl:Oe,NgrokTab:yt},data(){return{currentTab:"Device",tabs:["Home","Experiment","Device","Remote"]}}};const ft=(0,O.Z)(Nt,[["render",s]]);var Bt=ft;let It="initial_flask";"8080"===window.location.port?(Et.Z.defaults.baseURL="http://localhost:5000",It=""):"3000"===window.location.port&&(Et.Z.defaults.baseURL="http://localhost:3000",It="/flask");var St={namespaced:!0,state:{calibrationModeEnabled:!1,valves:{states:{1:"open",2:"open",3:"open",4:"open",5:"open",6:"open",7:"open"}},pumps:{states:{1:"stopped",2:"stopped",3:"stopped"},volume:{1:0,2:0,3:0},calibration:{1:{1:.2,5:.19,10:.18,50:.17},2:{1:.2,5:.19,10:.18,50:.17},3:{1:.2,5:.19,10:.18,50:.17}}},stirrers:{states:{1:"stopped",2:"high",3:"low",4:"stopped",5:"stopped",6:"stopped",7:"stopped"},calibration:{1:{low:40,high:50},2:{low:40,high:50},3:{low:40,high:50},4:{low:40,high:50},5:{low:40,high:50},6:{low:40,high:50},7:{low:40,high:50}}},ods:{states:{1:0,2:0,3:0,4:0,5:0,6:0,7:0},calibration:{1:{.00788:40.375,.0158:39.781,.0315:38.664,.063:36.508,.126:32.789,.252:26.75,.504:18.367,1.01:9.719,2.02:3.961,4.03:1.648},2:{.00788:40.375,.0158:39.781,.0315:38.664,.063:36.508,.126:32.789,.252:26.75,.504:18.367,1.01:9.719,2.02:3.961,4.03:1.648},3:{.00788:40.375,.0158:39.781,.0315:38.664,.063:36.508,.126:32.789,.252:26.75,.504:18.367,1.01:9.719,2.02:3.961,4.03:1.648},4:{.00788:40.375,.0158:39.781,.0315:38.664,.063:36.508,.126:32.789,.252:26.75,.504:18.367,1.01:9.719,2.02:3.961,4.03:1.648},5:{.00788:40.375,.0158:39.781,.0315:38.664,.063:36.508,.126:32.789,.252:26.75,.504:18.367,1.01:9.719,2.02:3.961,4.03:1.648},6:{.00788:40.375,.0158:39.781,.0315:38.664,.063:36.508,.126:32.789,.252:26.75,.504:18.367,1.01:9.719,2.02:3.961,4.03:1.648},7:{.00788:40.375,.0158:39.781,.0315:38.664,.063:36.508,.126:32.789,.252:26.75,.504:18.367,1.01:9.719,2.02:3.961,4.03:1.648}}},odsignals:{1:40,2:40,3:40,4:40,5:40,6:40,7:40},temperatures:{states:{1:0,2:0}}},mutations:{setPartCalibration(e,{devicePart:t,partIndex:o,newCalibration:n}){e[t].calibration[o]=n},setPartState(e,{devicePart:t,partIndex:o,newState:n}){e[t].states[o]=n},setAllDeviceStates(e,t){e.valves=t.valves,e.pumps=t.pumps,e.stirrers=t.stirrers,e.ods=t.ods,e.odsignals=t.odsignals,e.temperatures=t.temperatures},toggleCalibrationMode(e){e.calibrationModeEnabled=!e.calibrationModeEnabled},addODCalibrationRow(e,t){const o=Object.keys(e.ods.calibration);console.log(o),o.forEach((o=>{e.ods.calibration[o][t]=null})),e.ods={...e.ods}}},actions:{setAllStirrersStateAction({dispatch:e,state:t},o){Object.keys(t.stirrers.states).forEach((t=>{e("setPartStateAction",{devicePart:"stirrers",partIndex:parseInt(t),newState:o})}))},setPartCalibrationAction({commit:e},t){const{devicePart:o,partIndex:n,newCalibration:a}=t,l=`/set-${o}-calibration`;return new Promise(((t,r)=>{console.log(It+l),Et.Z.post(It+l,{partIndex:n,newCalibration:a}).then((a=>{a.data.success?(e("setPartCalibration",{devicePart:o,partIndex:n,newCalibration:a.data.newCalibration}),t()):(console.error(`Error updating ${o} calibration:`,a.data.message),r())})).catch((e=>{console.error(`Error updating ${o} calibration:`,e),r()}))}))},setPartStateAction({commit:e},t){const{devicePart:o,partIndex:n,newState:a,input:l}=t,r=`/set-${o}-state`;return console.log(t),console.log("Setting part state action",`${It}${r}`,{partIndex:n,newState:a,input:l}),new Promise(((t,i)=>{Et.Z.post(`${It}${r}`,{partIndex:n,newState:a,input:l}).then((a=>{console.log("Response data:",a.data),a.data.success?(console.log("Success setting part state action",a.data.newState),e("setPartState",{devicePart:o,partIndex:n,newState:a.data.newState}),t()):(console.error(`Error updating ${o} state:`,a.data.message),i())})).catch((e=>{console.error(`Error updating ${o} state:`,e),i()}))}))},getAllDeviceData({commit:e}){return new Promise(((t,o)=>{console.log("Fetching all device data from url",Et.Z.defaults.baseURL+It+"/get-all-device-data"),Et.Z.get(It+"/get-all-device-data").then((n=>{n.data.success?(e("setAllDeviceStates",n.data.device_states),t()):(console.error("Error fetching device data: server responded with an error"),o())})).catch((e=>{console.error("Error fetching device data:",e),o(e)}))}))},measureDevicePart({commit:e},t){const{devicePart:o,partIndex:n}=t,a=`/measure-${o}`;return new Promise(((t,l)=>{Et.Z.post(It+a,{partIndex:n}).then((n=>{n.data.success?(e("setAllDeviceStates",n.data.device_states),t()):(console.error(`Error measuring ${o}:`,n.data.message),l())})).catch((e=>{console.error(`Error measuring ${o}:`,e),l()}))}))}}};n["default"].use(f.ZP);var xt=new f.ZP.Store({modules:{device:St}}),Dt=o(9657),Pt=o(3017);const Rt=(0,n.createApp)(Bt);Rt.directive("click-outside",{beforeMount(e,t){e.clickOutsideEvent=o=>{e===o.target||e.contains(o.target)||o.target.classList.contains("input")||t.value()},document.addEventListener("click",e.clickOutsideEvent)},beforeUnmount(e){document.removeEventListener("click",e.clickOutsideEvent)}}),Rt.use(B.CoreuiVue).use(Dt.XG7).use(Pt.A7).use(xt).mount("#app")}},t={};function o(n){var a=t[n];if(void 0!==a)return a.exports;var l=t[n]={exports:{}};return e[n].call(l.exports,l,l.exports,o),l.exports}o.m=e,function(){var e=[];o.O=function(t,n,a,l){if(!n){var r=1/0;for(d=0;d<e.length;d++){n=e[d][0],a=e[d][1],l=e[d][2];for(var i=!0,s=0;s<n.length;s++)(!1&l||r>=l)&&Object.keys(o.O).every((function(e){return o.O[e](n[s])}))?n.splice(s--,1):(i=!1,l<r&&(r=l));if(i){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[n,a,l]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var a,l,r=n[0],i=n[1],s=n[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(a in i)o.o(i,a)&&(o.m[a]=i[a]);if(s)var d=s(o)}for(t&&t(n);c<r.length;c++)l=r[c],o.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return o.O(d)},n=self["webpackChunkreplifactory_gui"]=self["webpackChunkreplifactory_gui"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[998],(function(){return o(5500)}));n=o.O(n)})();
//# sourceMappingURL=app.79d9b278.js.map